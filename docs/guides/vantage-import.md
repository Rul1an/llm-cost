# Integrating with Vantage (FOCUS 1.0)

`llm-cost` natively supports exporting cost estimates in the **FinOps Open Cost & Usage Specification (FOCUS) v1.0** format. This output is optimized for direct ingestion into cloud cost management tools like **Vantage** via their "Custom Provider" feature.

## Exporting Costs

To generate a FOCUS-compliant CSV file, run:

```bash
llm-cost export --format focus --output costs.csv
```

### Options

| Flag | Description |
|---|---|
| `--output <file>` | Path to output CSV file (defaults to stdout). |
| `--manifest <path>` | Path to `llm-cost.toml` (defaults to current directory). |
| `--cache-hit-ratio <0.0-1.0>` | Override cache hit ratio for `x-cache-hit-ratio` tag (static analysis). |

## Vantage Integration

1. **Log in to Vantage Console**.
2. Navigate to **Integrations** > **Custom Providers**.
3. Create a new provider named "LLM Cost" (or similar).
4. Upload the `costs.csv` generated by `llm-cost`.
5. Vantage will automatically map the FOCUS columns.

### Column Mapping (Protocol)

`llm-cost` outputs the following strict FOCUS 1.0 columns:

| Column | Value | Notes |
|---|---|---|
| `ChargePeriodStart` | `YYYY-MM-DD` | Defaults to today (UTC). |
| `ChargeCategory` | `Usage` | Fixed. |
| `BilledCost` | `0.1234` | Estimated cost in USD. |
| `ServiceName` | `LLM Inference` | Fixed. |
| `ServiceCategory` | `AI and Machine Learning` | Fixed. |
| `ResourceId` | `<slug>` | Derived from prompt ID or path. |
| `Tags` | JSON String | Contains metadata (Team, App, Provider). |

### Tags & Metadata

Extra metadata is embedded in the `Tags` column as a JSON object, ensuring full compatibility with Vantage's tag filtering:

- `llm-cost-type`: `estimate`
- `provider`: `OpenAI` (e.g.)
- `model`: `gpt-4o`
- `resource-name`: `prompts/search.txt`
- `effective-cost`: `0.1234`
- `x-token-count-input`: `100`
- `x-token-count-output`: `50`
- User usage tags (e.g., `team`, `app`) defined in `llm-cost.toml`.

## Automation (CI/CD)

You can automate this in GitHub Actions to upload costs daily:

```yaml
- name: Calculate & Export Costs
  run: |
    llm-cost export --format focus -o costs.csv

- name: Upload to Vantage
  uses: vantage-sh/upload-action@v1
  with:
    file: costs.csv
    provider_id: ${{ secrets.VANTAGE_PROVIDER_ID }}
```
